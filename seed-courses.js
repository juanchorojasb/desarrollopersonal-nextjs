// seed-courses.js
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

async function main() {
  console.log('üå± Iniciando seed de cursos...');
  
  try {
    // Limpiar datos existentes (opcional)
    // await prisma.lessonProgress.deleteMany({});
    // await prisma.enrollment.deleteMany({});
    // await prisma.lesson.deleteMany({});
    // await prisma.module.deleteMany({});
    // await prisma.course.deleteMany({});

    console.log('üìö Creando curso de Inteligencia Emocional...');
    
    // Crear curso principal de Inteligencia Emocional
    const curso1 = await prisma.course.create({
      data: {
        title: 'Fundamentos de Inteligencia Emocional',
        description: 'Un curso completo que te ense√±ar√° a dominar tus emociones y mejorar significativamente tus relaciones interpersonales. Aprender√°s t√©cnicas cient√≠ficamente probadas para gestionar el estr√©s, aumentar tu autoconciencia y desarrollar habilidades sociales que transformar√°n tu vida personal y profesional.',
        shortDesc: 'Domina tus emociones y transforma tu vida',
        level: 'beginner',
        category: 'Desarrollo Personal',
        price: 97,
        currency: 'USD',
        status: 'published',
        featured: true,
        duration: 480, // 8 horas
        instructor: 'Dra. Mar√≠a Gonz√°lez',
        thumbnail: '/api/placeholder/800/400',
        trailerVideo: 'https://desarrollopersonal.b-cdn.net/trailer-ie.mp4',
        modules: {
          create: [
            {
              title: 'Introducci√≥n a la Inteligencia Emocional',
              description: 'Fundamentos b√°sicos y conceptos clave para entender la inteligencia emocional',
              position: 1,
              duration: 90,
              lessons: {
                create: [
                  {
                    title: '¬øQu√© es la Inteligencia Emocional?',
                    description: 'Definici√≥n, historia y importancia en la vida moderna',
                    position: 1,
                    type: 'video',
                    videoDuration: 900, // 15 minutos
                    isPreview: true,
                    videoUrl: 'https://iframe.mediadelivery.net/play/476857/sample-video-1',
                    content: 'En esta lecci√≥n exploraremos qu√© significa realmente la inteligencia emocional y por qu√© es tan importante en nuestras vidas...'
                  },
                  {
                    title: 'Los 4 Pilares Fundamentales',
                    description: 'Autoconciencia, autorregulaci√≥n, empat√≠a y habilidades sociales',
                    position: 2,
                    type: 'video',
                    videoDuration: 1200, // 20 minutos
                    isPreview: true,
                    videoUrl: 'https://iframe.mediadelivery.net/play/476857/sample-video-2',
                    content: 'Los cuatro pilares de la inteligencia emocional son la base de todo crecimiento personal...'
                  },
                  {
                    title: 'Test de Evaluaci√≥n Inicial',
                    description: 'Eval√∫a tu nivel actual de inteligencia emocional',
                    position: 3,
                    type: 'quiz',
                    videoDuration: 600, // 10 minutos
                    isPreview: false,
                    content: 'Antes de continuar, es importante que eval√∫es tu nivel actual...'
                  }
                ]
              }
            },
            {
              title: 'Autoconciencia Emocional',
              description: 'Aprende a identificar y comprender tus emociones profundamente',
              position: 2,
              duration: 120,
              lessons: {
                create: [
                  {
                    title: 'Identificando tus Emociones',
                    description: 'T√©cnicas pr√°cticas para reconocer emociones en tiempo real',
                    position: 1,
                    type: 'video',
                    videoDuration: 1500, // 25 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/ie-identificar.mp4',
                    content: 'La primera habilidad de la inteligencia emocional es reconocer nuestras emociones...'
                  },
                  {
                    title: 'El Diario Emocional',
                    description: 'Herramienta pr√°ctica para el seguimiento emocional diario',
                    position: 2,
                    type: 'video',
                    videoDuration: 1080, // 18 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/ie-diario.mp4',
                    content: 'El diario emocional es una herramienta poderosa para desarrollar autoconciencia...'
                  },
                  {
                    title: 'Ejercicios de Mindfulness',
                    description: 'Pr√°cticas de atenci√≥n plena para aumentar la conciencia presente',
                    position: 3,
                    type: 'video',
                    videoDuration: 1320, // 22 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/ie-mindfulness.mp4',
                    content: 'El mindfulness nos ayuda a estar presentes con nuestras emociones...'
                  }
                ]
              }
            },
            {
              title: 'Autorregulaci√≥n Emocional',
              description: 'T√©cnicas avanzadas para gestionar y controlar tus emociones',
              position: 3,
              duration: 150,
              lessons: {
                create: [
                  {
                    title: 'T√©cnicas de Respiraci√≥n',
                    description: 'M√©todos probados para calmar el sistema nervioso instant√°neamente',
                    position: 1,
                    type: 'video',
                    videoDuration: 1200, // 20 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/ie-respiracion.mp4',
                    content: 'La respiraci√≥n consciente es la herramienta m√°s poderosa para la autorregulaci√≥n...'
                  },
                  {
                    title: 'Reestructuraci√≥n Cognitiva',
                    description: 'Aprende a cambiar patrones de pensamiento negativos',
                    position: 2,
                    type: 'video',
                    videoDuration: 1680, // 28 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/ie-cognitiva.mp4',
                    content: 'Nuestros pensamientos influyen directamente en nuestras emociones...'
                  },
                  {
                    title: 'Gesti√≥n del Estr√©s',
                    description: 'Estrategias efectivas para manejar situaciones estresantes',
                    position: 3,
                    type: 'video',
                    videoDuration: 1800, // 30 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/ie-estres.mp4',
                    content: 'El estr√©s es inevitable, pero podemos aprender a gestionarlo eficazmente...'
                  }
                ]
              }
            }
          ]
        }
      }
    });

    console.log('üßò Creando curso de Mindfulness...');

    // Crear curso de Mindfulness
    const curso2 = await prisma.course.create({
      data: {
        title: 'Mindfulness y Meditaci√≥n Pr√°ctica',
        description: 'Un curso completo para incorporar mindfulness en tu vida diaria y reducir el estr√©s de manera efectiva. Aprender√°s t√©cnicas de meditaci√≥n, ejercicios de respiraci√≥n y pr√°cticas de atenci√≥n plena que transformar√°n tu bienestar mental.',
        shortDesc: 'Encuentra paz interior y claridad mental',
        level: 'beginner',
        category: 'Bienestar',
        price: 127,
        currency: 'USD',
        status: 'published',
        featured: true,
        duration: 360, // 6 horas
        instructor: 'Jorge Mart√≠nez',
        thumbnail: '/api/placeholder/800/400',
        trailerVideo: 'https://desarrollopersonal.b-cdn.net/trailer-mindfulness.mp4',
        modules: {
          create: [
            {
              title: 'Fundamentos del Mindfulness',
              description: 'Introducci√≥n a los conceptos b√°sicos de la atenci√≥n plena',
              position: 1,
              duration: 90,
              lessons: {
                create: [
                  {
                    title: 'Historia y Origen del Mindfulness',
                    description: 'Ra√≠ces budistas y aplicaci√≥n moderna',
                    position: 1,
                    type: 'video',
                    videoDuration: 720, // 12 minutos
                    isPreview: true,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/mindfulness-historia.mp4'
                  },
                  {
                    title: 'Beneficios Cient√≠ficos',
                    description: 'Estudios e investigaciones sobre mindfulness',
                    position: 2,
                    type: 'video',
                    videoDuration: 1080, // 18 minutos
                    isPreview: true,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/mindfulness-beneficios.mp4'
                  }
                ]
              }
            },
            {
              title: 'T√©cnicas de Meditaci√≥n',
              description: 'Aprende diferentes tipos de meditaci√≥n mindfulness',
              position: 2,
              duration: 120,
              lessons: {
                create: [
                  {
                    title: 'Meditaci√≥n de Respiraci√≥n',
                    description: 'La t√©cnica fundamental de atenci√≥n a la respiraci√≥n',
                    position: 1,
                    type: 'video',
                    videoDuration: 1500, // 25 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/mindfulness-respiracion.mp4'
                  },
                  {
                    title: 'Body Scan o Exploraci√≥n Corporal',
                    description: 'T√©cnica para desarrollar conciencia corporal',
                    position: 2,
                    type: 'video',
                    videoDuration: 1800, // 30 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/mindfulness-bodyscan.mp4'
                  }
                ]
              }
            }
          ]
        }
      }
    });

    console.log('üíº Creando curso de Liderazgo...');

    // Crear curso de Liderazgo
    const curso3 = await prisma.course.create({
      data: {
        title: 'Liderazgo Transformacional',
        description: 'Desarrolla habilidades de liderazgo que inspiren y motiven equipos de alto rendimiento. Aprende a comunicar visi√≥n, gestionar conflictos y crear una cultura de excelencia en tu organizaci√≥n.',
        shortDesc: 'Convi√©rtete en el l√≠der que admirar√≠as',
        level: 'intermediate',
        category: 'Liderazgo',
        price: 197,
        currency: 'USD',
        status: 'published',
        featured: false,
        duration: 720, // 12 horas
        instructor: 'Carlos Ru√≠z',
        thumbnail: '/api/placeholder/800/400',
        modules: {
          create: [
            {
              title: 'Bases del Liderazgo',
              description: 'Fundamentos te√≥ricos y pr√°cticos del liderazgo efectivo',
              position: 1,
              duration: 180,
              lessons: {
                create: [
                  {
                    title: 'Tipos de Liderazgo',
                    description: 'Estilos de liderazgo y cu√°ndo aplicar cada uno',
                    position: 1,
                    type: 'video',
                    videoDuration: 1320, // 22 minutos
                    isPreview: true,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/liderazgo-tipos.mp4'
                  },
                  {
                    title: 'Autoliderazgo',
                    description: 'Liderarte a ti mismo antes de liderar a otros',
                    position: 2,
                    type: 'video',
                    videoDuration: 1680, // 28 minutos
                    isPreview: false,
                    videoUrl: 'https://desarrollopersonal.b-cdn.net/liderazgo-auto.mp4'
                  }
                ]
              }
            }
          ]
        }
      }
    });

    console.log('üèÜ Creando achievements b√°sicos...');

    // Crear algunos achievements b√°sicos
    const achievements = await prisma.achievement.createMany({
      data: [
        {
          name: 'Primera Lecci√≥n',
          description: 'Completaste tu primera lecci√≥n',
          icon: 'üéØ',
          type: 'lesson_completion',
          criteria: JSON.stringify({ lessons_completed: 1 }),
          xpReward: 50,
          isActive: true
        },
        {
          name: 'Estudiante Dedicado',
          description: 'Completaste 10 lecciones',
          icon: 'üìö',
          type: 'lesson_completion',
          criteria: JSON.stringify({ lessons_completed: 10 }),
          xpReward: 200,
          isActive: true
        },
        {
          name: 'Primer Curso',
          description: 'Completaste tu primer curso completo',
          icon: 'üéì',
          type: 'course_completion',
          criteria: JSON.stringify({ courses_completed: 1 }),
          xpReward: 500,
          isActive: true
        },
        {
          name: 'Racha de 7 d√≠as',
          description: 'Estudiaste durante 7 d√≠as consecutivos',
          icon: 'üî•',
          type: 'streak',
          criteria: JSON.stringify({ streak_days: 7 }),
          xpReward: 300,
          isActive: true
        },
        {
          name: 'Maestro del Mindfulness',
          description: 'Completaste el curso de Mindfulness',
          icon: 'üßò',
          type: 'specific_course',
          criteria: JSON.stringify({ course_id: curso2.id }),
          xpReward: 1000,
          isActive: true
        }
      ]
    });

    console.log('‚úÖ Seed completado exitosamente!');
    console.log(`üìö Cursos creados: ${curso1.title}, ${curso2.title}, ${curso3.title}`);
    console.log(`üèÜ ${achievements.count} achievements creados`);
    console.log('');
    console.log('üåê Ahora puedes visitar:');
    console.log('   üìö http://31.97.85.16:3001/dashboard/cursos');
    console.log('   üéØ http://31.97.85.16:3001/dashboard');
    console.log('');

  } catch (error) {
    console.error('‚ùå Error durante el seed:', error);
    throw error;
  }
}

main()
  .catch((e) => {
    console.error('‚ùå Error fatal:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
